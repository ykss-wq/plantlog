<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>PlantLog</title>
  <meta name="theme-color" content="#f4efe6" />

  <style>
    :root{
      --bg:#f4efe6;
      --panel:#ffffff;
      --panel2:#fbf7f0;
      --line:#e7ded2;

      --text:#2b2b2b;
      --muted:#7a756b;

      --accent:#6a8f6a;
      --accent2:#94b594;

      --danger:#ef4444;
      --danger2:#fb7185;

      --shadow: 0 10px 28px rgba(60,40,20,.10);
      --shadow2: 0 6px 18px rgba(60,40,20,.08);
      --radius:22px;
      --radius2:16px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic",sans-serif;
      color:var(--text);
      background: var(--bg);
      padding:
        calc(env(safe-area-inset-top) + 14px)
        14px
        calc(env(safe-area-inset-bottom) + 140px); /* âœ… ä¸‹ã‚¿ãƒ–ã«è¢«ã‚‰ãªã„ */
      overflow-x:hidden;
      position:relative;
    }

    /* soft background */
    body:before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.55;
      background:
        radial-gradient(800px 520px at 10% 25%, rgba(106,143,106,.14), transparent 60%),
        radial-gradient(700px 520px at 95% 22%, rgba(148,181,148,.12), transparent 60%),
        radial-gradient(700px 520px at 50% 110%, rgba(106,143,106,.08), transparent 62%);
    }

    .wrap{max-width:980px;margin:0 auto; position:relative;}
    .grid{display:grid;gap:14px}

    header{
      position:sticky; top:0; z-index:20;
      margin:-6px 0 10px;
      padding: 8px 0 12px;
      background: rgba(244,239,230,.86);
      backdrop-filter: blur(10px);
      border-bottom:1px solid rgba(231,222,210,.75);
    }

    .top{
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
      padding: 0 2px 10px;
    }
    .brand{display:flex; align-items:center; gap:10px;}
    .logo{
      width:40px;height:40px;border-radius:14px;
      display:grid;place-items:center;
      background: linear-gradient(135deg, rgba(106,143,106,.18), rgba(148,181,148,.14));
      border:1px solid rgba(231,222,210,.85);
      box-shadow: var(--shadow2);
      font-size:18px;
    }
    .title{margin:0;font-size:20px;letter-spacing:.2px;line-height:1.1;}
    .subtitle{margin-top:4px;font-size:12px;color:var(--muted);}

    .pill{
      font-size:12px;
      color:var(--muted);
      padding:8px 12px;
      border:1px solid var(--line);
      border-radius:999px;
      background: rgba(255,255,255,.72);
      box-shadow: 0 8px 18px rgba(60,40,20,.06);
      white-space:nowrap;
    }

    /* top tabs scroll */
    .tabs{
      display:flex; gap:10px;
      overflow-x:auto;
      -webkit-overflow-scrolling:touch;
      padding: 0 2px 4px;
      scrollbar-width:none;
    }
    .tabs::-webkit-scrollbar{display:none}
    .tab{
      flex:0 0 auto;
      display:flex; align-items:center; gap:8px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.78);
      box-shadow: var(--shadow2);
      cursor:pointer;
      user-select:none;
      font-weight:800;
      font-size:14px;
    }
    .tab.active{
      background: linear-gradient(90deg, rgba(106,143,106,.22), rgba(148,181,148,.16));
      border-color: rgba(106,143,106,.35);
    }

    .card{
      border:1px solid rgba(231,222,210,.95);
      border-radius: var(--radius);
      background: rgba(255,255,255,.88);
      box-shadow: var(--shadow);
      padding: 16px;
      overflow:hidden;
    }
    .card.soft{background: rgba(255,255,255,.80); box-shadow:none;}
    .cardTitle{margin:0 0 6px;font-size:18px;letter-spacing:.2px;display:flex;gap:8px;align-items:center;}
    .sub{color:var(--muted);font-size:13px;line-height:1.6;}
    .hr{height:1px;background:rgba(231,222,210,.9); margin:14px 0}

    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
    .btn{
      border:none;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      color:#133016;
      font-weight:900;
      padding:12px 14px;
      border-radius:14px;
      cursor:pointer;
      box-shadow: 0 12px 24px rgba(106,143,106,.18);
    }
    .btn.small{padding:10px 12px;font-size:13px;border-radius:12px}
    .btn.ghost{
      background: rgba(255,255,255,.9);
      border:1px solid var(--line);
      box-shadow:none;
      color:var(--text);
      font-weight:900;
    }
    .btn.danger{
      background: linear-gradient(90deg, var(--danger), var(--danger2));
      color:#2a0b0b;
      box-shadow: 0 12px 24px rgba(239,68,68,.16);
    }

    input,select,textarea{
      width:100%;
      border:1px solid var(--line);
      border-radius:14px;
      padding:12px 12px;
      background: rgba(255,255,255,.75);
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    textarea{min-height:92px;resize:vertical}
    label{display:block;margin:12px 0 6px;font-size:12px;color:var(--muted)}

    .steps{
      display:grid;
      gap:10px;
      margin-top:12px;
    }
    .step{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding:12px;
      border-radius: var(--radius2);
      border:1px solid rgba(231,222,210,.95);
      background: rgba(255,255,255,.78);
      box-shadow: 0 8px 18px rgba(60,40,20,.06);
    }
    .stepNo{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      font-weight:999;
      color:#133016;
      background: linear-gradient(90deg, rgba(106,143,106,.25), rgba(148,181,148,.18));
      border:1px solid rgba(106,143,106,.25);
      flex:0 0 auto;
    }
    .stepBody{flex:1}
    .stepTitle{font-weight:999;margin:0}
    .stepDesc{margin-top:4px;color:var(--muted);font-size:12px;line-height:1.5}

    .hintBox{
      margin-top:12px;
      padding:12px;
      border-radius: var(--radius2);
      background: rgba(251,247,240,.95);
      border:1px dashed rgba(231,222,210,.95);
      color:var(--muted);
      font-size:12px;
      line-height:1.6;
    }

    .fileRow{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;
      margin-top:10px;
    }
    .fileRow input[type="file"]{
      flex:1;
      min-width: 220px;
      background: rgba(255,255,255,.75);
    }

    /* bottom nav */
    .bottomNav{
      position:fixed;
      left:14px; right:14px;
      bottom: calc(env(safe-area-inset-bottom) + 18px);
      height:66px;
      border-radius: 20px;
      border:1px solid rgba(231,222,210,.95);
      background: rgba(255,255,255,.86);
      box-shadow: 0 18px 40px rgba(60,40,20,.14);
      display:flex;
      overflow:hidden;
      z-index:40;
      backdrop-filter: blur(10px);
      touch-action: manipulation;
    }
    .navBtn{
      flex:1;
      border:none;
      background:transparent;
      display:flex;flex-direction:column;
      align-items:center;justify-content:center;
      gap:6px;
      color:var(--muted);
      font-weight:999;
      cursor:pointer;
    }
    .navBtn .ico{font-size:18px;line-height:1}
    .navBtn.active{color: var(--accent)}
    .navMid{
      width:72px;
      display:flex;align-items:center;justify-content:center;
      border-left:1px solid rgba(231,222,210,.75);
      border-right:1px solid rgba(231,222,210,.75);
      background: linear-gradient(180deg, rgba(106,143,106,.10), rgba(255,255,255,.0));
    }
    .navMid button{
      width:46px;height:46px;border-radius:16px;
      border:none;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      color:#133016;font-weight:999;
      box-shadow: 0 14px 26px rgba(106,143,106,.22);
      cursor:pointer;
      font-size:20px;
    }

    /* small footer line */
    .tiny{font-size:12px;color:var(--muted)}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="top">
        <div class="brand">
          <div class="logo">ğŸƒ</div>
          <div>
            <h1 class="title">PlantLog</h1>
            <div class="subtitle">æ¤ç‰©ã®ç®¡ç†ã‚’å„ªã—ãã‹ã‚“ãŸã‚“ã«</div>
          </div>
        </div>
        <div class="pill" id="statusPill">ä¿å­˜: ç«¯æœ«ã®ä¸­</div>
      </div>

      <div class="tabs" id="tabs">
        <div class="tab active" data-tab="today">ğŸ  ä»Šæ—¥</div>
        <div class="tab" data-tab="plants">ğŸŒ¿ æ¤ç‰©</div>
        <div class="tab" data-tab="add">â• è¿½åŠ </div>
        <div class="tab" data-tab="diag">ğŸ©º ãƒã‚§ãƒƒã‚¯</div>
        <div class="tab" data-tab="backup">ğŸ’¾ å¼•ã£è¶Šã—ãƒ»ä¿å­˜</div>
      </div>
    </header>

    <main class="grid">
      <!-- TODAY (ç°¡æ˜“) -->
      <section class="card" id="view-today">
        <h2 class="cardTitle">ğŸ  ä»Šæ—¥</h2>
        <div class="sub">ã“ã“ã¯å¾Œã§è‚²ã¦ã‚‹ã€‚ä»Šã¯ã€Œå¼•ã£è¶Šã—ãƒ»ä¿å­˜ã€ã‚’åˆ†ã‹ã‚Šã‚„ã™ãã™ã‚‹ã®ãŒç›®çš„ã€‚</div>
      </section>

      <!-- PLANTS (ãƒ€ãƒŸãƒ¼) -->
      <section class="card" id="view-plants" style="display:none">
        <h2 class="cardTitle">ğŸŒ¿ æ¤ç‰©</h2>
        <div class="sub">ï¼ˆçœç•¥ï¼‰</div>
      </section>

      <!-- ADD (ãƒ€ãƒŸãƒ¼) -->
      <section class="card" id="view-add" style="display:none">
        <h2 class="cardTitle">â• è¿½åŠ </h2>
        <div class="sub">ï¼ˆçœç•¥ï¼‰</div>
      </section>

      <!-- DIAG (ãƒ€ãƒŸãƒ¼) -->
      <section class="card" id="view-diag" style="display:none">
        <h2 class="cardTitle">ğŸ©º ãƒã‚§ãƒƒã‚¯</h2>
        <div class="sub">ï¼ˆçœç•¥ï¼‰</div>
      </section>

      <!-- BACKUP (ã“ã“ãŒæœ¬å‘½ï¼šç´ äººå‘ã‘) -->
      <section class="card" id="view-backup" style="display:none">
        <h2 class="cardTitle">ğŸ’¾ å¼•ã£è¶Šã—ãƒ»ä¿å­˜</h2>
        <div class="sub">
          ã‚¹ãƒãƒ›ã‚’å¤‰ãˆã‚‹æ™‚ãƒ»æ¶ˆã—ãŸããªã„æ™‚ã®ãŸã‚ã«ã€ãƒ‡ãƒ¼ã‚¿ã‚’<strong>ä¿å­˜</strong>ã§ãã¾ã™ã€‚<br>
          â€»ãµã ã‚“ã¯è‡ªå‹•ã§ç«¯æœ«ã«ä¿å­˜ã•ã‚Œã¦ã„ã¾ã™ã€‚
        </div>

        <div class="hr"></div>

        <div class="card soft">
          <h3 style="margin:0 0 6px">â‘  ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ï¼ˆãŠã™ã™ã‚ï¼‰</h3>
          <div class="sub">ã¾ãšã¯ã“ã‚Œã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚¢ãƒ—ãƒªã‚„iCloudã«ç½®ã‘ã¾ã™ã€‚</div>

          <div class="steps">
            <div class="step">
              <div class="stepNo">1</div>
              <div class="stepBody">
                <div class="stepTitle">ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹</div>
                <div class="stepDesc">PlantLogã®ä¸­èº«ã‚’ã¾ã¨ã‚ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚</div>
                <div class="row" style="margin-top:10px">
                  <button class="btn" id="exportBtn">â¬‡ï¸ ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ï¼ˆãŠã™ã™ã‚ï¼‰</button>
                </div>
              </div>
            </div>

            <div class="step">
              <div class="stepNo">2</div>
              <div class="stepBody">
                <div class="stepTitle">ã€Œãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚¢ãƒ—ãƒªã«ä¿å­˜</div>
                <div class="stepDesc">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¾Œã€iCloudã‚„æœ¬ä½“ã«ä¿å­˜ã—ã¦ãŠã‘ã°å®‰å¿ƒã§ã™ã€‚</div>
              </div>
            </div>
          </div>

          <div class="hintBox">
            ğŸ’¡ ã‚³ãƒ„ï¼šæœˆ1å›ã ã‘ã§ã‚‚ã€Œä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ã€ã‚’ã‚„ã£ã¦ãŠãã¨æœ€å¼·ã€‚<br>
            åå‰ãŒé›£ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã‚‚ä¸­èº«ã¯PlantLogã®ãƒ‡ãƒ¼ã‚¿ã§ã™ï¼ˆæ°—ã«ã—ãªãã¦OKï¼‰ã€‚
          </div>
        </div>

        <div class="hr"></div>

        <div class="card soft">
          <h3 style="margin:0 0 6px">â‘¡ ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æˆ»ã™ï¼ˆå¾©å…ƒï¼‰</h3>
          <div class="sub">ã‚¹ãƒãƒ›ã‚’å¤‰ãˆãŸæ™‚ãƒ»æ¶ˆãˆãŸæ™‚ã«ã€ä¿å­˜ã—ã¦ãŠã„ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§æˆ»ã›ã¾ã™ã€‚</div>

          <div class="steps">
            <div class="step">
              <div class="stepNo">1</div>
              <div class="stepBody">
                <div class="stepTitle">ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã¶</div>
                <div class="stepDesc">ã•ã£ãä½œã£ãŸä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚</div>
                <div class="fileRow">
                  <input id="importInput" type="file" accept="application/json" />
                </div>
              </div>
            </div>

            <div class="step">
              <div class="stepNo">2</div>
              <div class="stepBody">
                <div class="stepTitle">å¾©å…ƒã™ã‚‹</div>
                <div class="stepDesc">é¸ã‚“ã ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æˆ»ã—ã¾ã™ã€‚</div>
                <div class="row" style="margin-top:10px">
                  <button class="btn" id="importBtn">â¬†ï¸ æˆ»ã™ï¼ˆå¾©å…ƒã™ã‚‹ï¼‰</button>
                </div>
              </div>
            </div>
          </div>

          <div class="hintBox">
            â€»ã€Œãƒ•ã‚¡ã‚¤ãƒ«ãŒé•ã†ã€ã¨å‡ºãŸã‚‰ï¼šPlantLogä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã‚“ã§ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
          </div>
        </div>

        <div class="hr"></div>

        <div class="card soft">
          <h3 style="margin:0 0 6px">â‘¢ å…¨éƒ¨æ¶ˆã™ï¼ˆæœ€çµ‚æ‰‹æ®µï¼‰</h3>
          <div class="sub">é–“é•ã£ã¦æŠ¼ã™ã¨æˆ»ã›ã¾ã›ã‚“ã€‚å…ˆã«â‘ ã§ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ã¦ã‹ã‚‰ã€‚</div>
          <div class="row" style="margin-top:10px">
            <button class="btn danger" id="wipeBtn">ğŸ§¨ å…¨ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆã™</button>
          </div>
        </div>

        <div class="hr"></div>

        <div class="tiny">
          ä¿å­˜å ´æ‰€ï¼šã“ã®ã‚¹ãƒãƒ›ã®ä¸­ï¼ˆlocalStorageï¼‰<br>
          â€»ã€Œä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã€ã¯è‡ªåˆ†ã§ä¿ç®¡ã™ã‚‹ç”¨ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã§ã™ã€‚
        </div>
      </section>
    </main>
  </div>

  <!-- Bottom nav -->
  <nav class="bottomNav" aria-label="Bottom Navigation">
    <button class="navBtn active" data-tab="today"><div class="ico">ğŸ </div><div style="font-size:11px">ä»Šæ—¥</div></button>
    <button class="navBtn" data-tab="plants"><div class="ico">ğŸŒ¿</div><div style="font-size:11px">æ¤ç‰©</div></button>
    <div class="navMid"><button type="button" id="nav-add">ï¼‹</button></div>
    <button class="navBtn" data-tab="diag"><div class="ico">ğŸ©º</div><div style="font-size:11px">ãƒã‚§ãƒƒã‚¯</div></button>
    <button class="navBtn" data-tab="backup"><div class="ico">ğŸ’¾</div><div style="font-size:11px">ä¿å­˜</div></button>
  </nav>

  <script>
    // ===== Tabs
    const views = ["today","plants","add","diag","backup"];
    const $ = (id)=>document.getElementById(id);

    function showTab(tab){
      views.forEach(v=>{
        const el = $("view-"+v);
        if(el) el.style.display = (v===tab) ? "" : "none";
      });
      document.querySelectorAll(".tab").forEach(el=>{
        el.classList.toggle("active", el.dataset.tab===tab);
      });
      document.querySelectorAll(".navBtn").forEach(el=>{
        el.classList.toggle("active", el.dataset.tab===tab);
      });
    }

    $("tabs").addEventListener("click",(e)=>{
      const t = e.target.closest(".tab");
      if(!t) return;
      showTab(t.dataset.tab);
    });
    document.querySelectorAll(".navBtn").forEach(btn=>{
      btn.addEventListener("click", ()=> showTab(btn.dataset.tab));
    });
    $("nav-add").addEventListener("click", ()=> showTab("add"));

    // ===== Data (æœ€ä½é™ï¼šä¿å­˜/å¾©å…ƒ/å…¨å‰Šé™¤ã ã‘)
    const LS_KEY = "plantlog_beige_v2";
    function loadState(){
      const raw = localStorage.getItem(LS_KEY);
      if(!raw) return { plants: [] };
      try{
        const obj = JSON.parse(raw);
        if(!obj || !Array.isArray(obj.plants)) return { plants: [] };
        return obj;
      }catch{ return { plants: [] }; }
    }
    function saveState(st){
      localStorage.setItem(LS_KEY, JSON.stringify(st));
      $("statusPill").textContent = "ä¿å­˜: ç«¯æœ«ã®ä¸­ âœ“";
      setTimeout(()=> $("statusPill").textContent = "ä¿å­˜: ç«¯æœ«ã®ä¸­", 800);
    }
    let state = loadState();

    function fmtDate(d){
      const x = new Date(d);
      const y = x.getFullYear();
      const m = String(x.getMonth()+1).padStart(2,"0");
      const dd = String(x.getDate()).padStart(2,"0");
      return `${y}-${m}-${dd}`;
    }

    function downloadText(filename, text, mime="application/json"){
      const blob = new Blob([text], { type:mime });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href=url; a.download=filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    }

    // âœ… ã“ã“ãŒã€ŒJSONã€ã˜ã‚ƒãªãã€Œä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã€æ‰±ã„
    $("exportBtn").onclick = ()=>{
      const payload = JSON.stringify(state, null, 2);
      downloadText(`PlantLog_ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«_${fmtDate(new Date())}.json`, payload, "application/json");
      alert("ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã£ãŸã‚ˆã€‚ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚¢ãƒ—ãƒªã«ä¿å­˜ã—ã¦ã­ã€‚");
    };

    $("importBtn").onclick = async ()=>{
      const f = $("importInput").files?.[0];
      if(!f){ alert("ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã‚“ã§ã­ã€‚"); return; }
      try{
        const obj = JSON.parse(await f.text());
        if(!obj || !Array.isArray(obj.plants)) throw new Error("format");
        state = obj;
        saveState(state);
        alert("å¾©å…ƒã§ããŸã‚ˆã€‚");
      }catch{
        alert("ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯PlantLogã®ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã˜ã‚ƒãªã„ã‹ã‚‚ã€‚åˆ¥ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã‚“ã§ã­ã€‚");
      }
    };

    $("wipeBtn").onclick = ()=>{
      if(!confirm("æœ¬å½“ã«å…¨éƒ¨æ¶ˆã™ï¼Ÿï¼ˆæˆ»ã›ãªã„ï¼‰\nå…ˆã«ã€ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œã‚‹ã€ã‚’ãŠã™ã™ã‚ï¼")) return;
      state = { plants: [] };
      saveState(state);
      alert("å…¨ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆã—ãŸã‚ˆã€‚");
    };

    // init
    showTab("today");
  </script>
</body>
</html>
